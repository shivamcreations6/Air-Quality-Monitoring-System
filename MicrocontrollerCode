#include <Arduino.h>
#include <U8g2lib.h>
#include <Wire.h>

// OLED display (I2C)
U8G2_SH1106_128X64_NONAME_F_HW_I2C u8g2(U8G2_R0, U8X8_PIN_NONE);

// Sensor pins
#define MQ7_PIN 34     // MQ-7 (Carbon Monoxide)
#define MQ135_PIN 35   // MQ-135 (Air Quality / CO2 / NH3)

void setup() {
  Serial.begin(115200);
  u8g2.begin();
  u8g2.setFont(u8g2_font_ncenB08_tr);

  Serial.println("MQ7 & MQ135 Gas Detection Started...");
}

void loop() {
  int mq7_value = analogRead(MQ7_PIN);
  int mq135_value = analogRead(MQ135_PIN);

  // Determine air quality conditions
  String mq7_status;
  String mq135_status;

  // --- MQ7 (Carbon Monoxide) ---
  if (mq7_value < 500) mq7_status = "Safe";
  else if (mq7_value < 1500) mq7_status = "Moderate";
  else mq7_status = "Dangerous";

  // --- MQ135 (Air Quality / CO2) ---
  if (mq135_value < 400) mq135_status = "Excellent";
  else if (mq135_value < 1000) mq135_status = "Moderate";
  else mq135_status = "Poor";

  // Print to Serial
  Serial.print("MQ7 (CO): ");
  Serial.print(mq7_value);
  Serial.print(" - ");
  Serial.print(mq7_status);
  Serial.print(" | MQ135 (CO2/NH3): ");
  Serial.print(mq135_value);
  Serial.print(" - ");
  Serial.println(mq135_status);

  // Display on OLED
  u8g2.clearBuffer();
  u8g2.setCursor(0, 12);
  u8g2.print("TEAM CEP 2015 MIT");

  u8g2.setCursor(0, 30);
  u8g2.print("CO (MQ7): ");
  u8g2.print(mq7_value);
  u8g2.print(" ");
  u8g2.print(mq7_status);

  u8g2.setCursor(0, 48);
  u8g2.print("CO2 (MQ135): ");
  u8g2.print(mq135_value);
  u8g2.print(" ");
  u8g2.print(mq135_status);

  u8g2.sendBuffer();

  delay(1000); // Update every second
}
